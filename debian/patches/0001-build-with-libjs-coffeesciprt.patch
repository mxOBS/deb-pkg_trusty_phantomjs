From: TANIGUCHI Takaki <takaki@asis.media-as.org>
Date: Sat, 29 Oct 2011 18:26:43 +0900
Subject: build with libjs-coffeesciprt

---
 python/pyphantomjs/csconverter.py |    2 +-
 python/pyphantomjs/resources.qrc  |    1 -
 src/csconverter.cpp               |    2 +-
 src/phantomjs.qrc                 |    1 -
 4 files changed, 2 insertions(+), 4 deletions(-)

Index: phantomjs/python/pyphantomjs/csconverter.py
===================================================================
--- phantomjs.orig/python/pyphantomjs/csconverter.py	2011-12-27 22:47:02.000000000 +0900
+++ phantomjs/python/pyphantomjs/csconverter.py	2011-12-27 22:50:37.014372207 +0900
@@ -36,7 +36,7 @@
 
         self.m_webPage = QWebPage(self)
 
-        with QPyFile(':/resources/coffee-script.js') as f:
+        with QPyFile('/usr/share/javascript/coffeescript/coffee-script.js') as f:
             self.m_webPage.mainFrame().evaluateJavaScript(f.readAll())
             self.m_webPage.mainFrame().addToJavaScriptWindowObject('converter', self)
 
Index: phantomjs/python/pyphantomjs/resources.qrc
===================================================================
--- phantomjs.orig/python/pyphantomjs/resources.qrc	2011-12-27 22:47:02.000000000 +0900
+++ phantomjs/python/pyphantomjs/resources.qrc	2011-12-27 22:50:49.146431522 +0900
@@ -5,7 +5,6 @@
         <file>modules/fs.js</file>
         <file>modules/webpage.js</file>
         <file>modules/webserver.js</file>
-        <file>resources/coffee-script.js</file>
         <file>resources/pyphantomjs-icon.png</file>
     </qresource>
 </RCC>
Index: phantomjs/src/csconverter.cpp
===================================================================
--- phantomjs.orig/src/csconverter.cpp	2011-12-27 22:47:02.000000000 +0900
+++ phantomjs/src/csconverter.cpp	2011-12-27 22:50:23.542306344 +0900
@@ -48,7 +48,7 @@
 CSConverter::CSConverter()
     : QObject(QCoreApplication::instance())
 {
-    m_webPage.mainFrame()->evaluateJavaScript(Utils::readResourceFileUtf8(":/coffee-script.js"));
+    m_webPage.mainFrame()->evaluateJavaScript(Utils::readResourceFileUtf8("/usr/share/javascript/coffeescript/coffee-script.js"));
     m_webPage.mainFrame()->addToJavaScriptWindowObject("converter", this);
 }
 
Index: phantomjs/src/phantomjs.qrc
===================================================================
--- phantomjs.orig/src/phantomjs.qrc	2011-12-27 22:47:02.000000000 +0900
+++ phantomjs/src/phantomjs.qrc	2011-12-27 22:49:32.810058325 +0900
@@ -3,7 +3,6 @@
         <file>debug_harness.html</file>
         <file>debug_wrapper.js</file>
         <file>phantomjs-icon.png</file>
-        <file>coffee-script.js</file>
         <file>usage.txt</file>
         <file>bootstrap.js</file>
         <file>configurator.js</file>
